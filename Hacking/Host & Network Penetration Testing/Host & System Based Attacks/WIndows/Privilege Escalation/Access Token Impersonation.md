
Brief
=
- core element of windows authentication process
- responsible for identifying and describing security context of process (like a web cookie)
- generated by winlogon.exe on login then attached to userinit.exe (used to create other processes) process

Methodology
=
Delegate-level token Impersonation:
1. get meterpreter shell
2. sysinfo
3. migrate to explorer `pgrep exploerer`  may not work session may die, restart process
4. `load incognito` meterpreter command
5. `list_tokens -u` - see what access tokens are available
6. `impersonate_token "copy paste token"`
7. `getuid`
8. if successful move to explorer process
9. `get privs`
10. list tokens again to see if you can impersonate authority system

Impersonate-level tokens
=
can be used to impersonate a token on the local system and not on any external systems that utilize token

created as a direct result of a non-interactive login on windows through specific system services or domain logons


Delegate-level tokens
=
pose largest threat as they can be used to impersonate tokens on any system

created through an interactive login on windows, through traditional logins or through remote access


Windows Privileges
=

SeAssignPrimaryToken - allows user to impersonate tokens

SeCreateToken - create an arbitrary token with admin privileges

SeImpersonatePrivilege - create a process under the security context of another user with admin privs

